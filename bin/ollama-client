#!/usr/bin/env raku
use v6.d;

use WWW::Ollama::Client;
use JSON::Fast;

my %*SUB-MAIN-OPTS = :named-anywhere;

#| Ollama client invocation.
sub MAIN(
        *@words,
        Str :$path = 'completions',          #= Path, one of 'completion', 'chat', 'embedding', 'model-info', 'list-models', or 'list-running-models'.
        Str :$model = 'gemma3:1b'
         ) {

    my $ollama = WWW::Ollama::Client.new;

    my %body = :$model, prompt => @words.join(' '), :!stream;

    my $ans = |$ollama.completion(%body);

    say to-json($ans, :pretty);
}
